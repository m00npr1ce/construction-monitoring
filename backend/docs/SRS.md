# SRS — Система мониторинга дефектов строительства

## 1. Введение
- Цель: монолитное веб‑приложение для централизованного управления дефектами на строительных объектах.
- Пользователи: Инженер, Менеджер, Наблюдатель (Клиент), Администратор.
- Термины: Дефект, Проект, Комментарий, Вложение, История изменений.

## 2. Область применения
- Регистрация, классификация, и контроль устранения дефектов.
- Назначение ответственных и сроков.
- Аналитическая отчётность.

## 3. Функциональные требования (FR)
1. Регистрация/аутентификация (JWT), хранение паролей (BCrypt).
2. Роли и разграничение доступа: ENGINEER, MANAGER, VIEWER, ADMIN.
3. Управление проектами: CRUD, даты начала/окончания.
4. Управление дефектами: CRUD; поля — заголовок, описание, приоритет, статус, исполнитель, сроки, проект.
5. Статусы дефектов: NEW → IN_PROGRESS → IN_REVIEW → CLOSED/ CANCELLED.
6. Комментарии к дефектам: CRUD (временно backend‑API; UI — в планах).
7. Вложения к дефектам: загрузка/скачивание/удаление (временно backend‑API; UI — в планах).
8. История изменений дефекта: запись изменений (backend есть; UI — в планах).
9. Фильтрация/поиск: по проекту/статусу/приоритету в UI, расширение — в планах.
10. Отчёты: Excel (полный), CSV (проекты/дефекты), базовая аналитика.

## 4. Нефункциональные требования (NFR)
- Производительность: отклик ≤ 1 сек для 50 одновременных пользователей (проверяется k6).
- Надёжность: ежедневный бэкап БД (описание и скрипт/инструкция).
- Безопасность: BCrypt; защита от SQL (JPA), XSS (санитайзинг/валидация), CSRF — API без cookie (JWT), CORS.
- Совместимость: Chrome/Firefox/Edge (последние версии).
- Локализация: интерфейс на русском (основные экраны локализованы).
- Адаптивность: Tailwind CSS сетка.

## 5. Ограничения и допущения
- Монолитный backend (Spring Boot, Java 21+), PostgreSQL, Vue 3 frontend.
- Docker/Compose для локальной/тестовой среды.

## 6. Модель данных (ERD)
- См. `diagrams/er-diagram.png`.
- Ключевые сущности: users, projects, defects, comments, attachments, defect_history.

## 7. Роли и права
- ENGINEER: просмотр; изменение статусов дефектов; комментарии/вложения.
- MANAGER: всё как инженер + создание проектов/дефектов; удаление в рамках политики.
- VIEWER: просмотр.
- ADMIN: полный доступ; управление пользователями и ролями.

## 8. API (высокий уровень)
- /api/auth: регистрация, логин.
- /api/projects: CRUD.
- /api/defects: CRUD, смена статусов.
- /api/comments, /api/attachments: CRUD (backend присутствует).
- /api/reports: аналитика, экспорт Excel/CSV.
- /api/users: список (ADMIN, MANAGER), назначение ролей (ADMIN).

## 9. UI
- Главная: виджеты статистики, кнопка отчёта.
- Проекты: список, детали, редактирование.
- Дефекты: список с фильтрами, создание, смена статусов.
- Админ: управление пользователями (роль/удаление).

## 10. Критерии приемки
- FR и RBAC работают согласно ролям.
- Экспорт Excel/CSV — скачиваются, содержимое корректно.
- Фильтры в дефектах корректно отрабатывают.
- Локализация: основные экраны и действия на русском.
- Нагрузочный сценарий: 50 VU, p95 ≤ 1 сек.

## 11. Тестирование
- Юнит/интеграционные тесты (см. `backend/src/test`).
- План тестирования и сценарии: см. `backend/docs/TestPlan.md`.
- Нагрузочное тестирование: см. `backend/docs/k6-load-test.js`.

## 12. Эксплуатация
- Деплой: инструкция `backend/docs/Deployment.md`.
- Бэкап БД: инструкция `backend/docs/Backup.md`.

## 13. Трассировка требований
- Матрица трассировки FR→API/UI→Тесты — в планах (таблица в репозитории документов, следующая версия).
